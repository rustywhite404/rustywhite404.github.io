---
title: 스택과 힙, 원시타입과 객체는 어디에 저장될까?           
date: 2025-02-21 21:02:58
categories: CS         
published: true 
tags:
- CS         
---  


![스택과 힙](https://i.imgur.com/z6mRPXU.png)  
간단히 이미지로 정리하자면 스택과 힙은 위와 같은 특성을 가지고 있다.  아래에서는 위 특성을 이해하면 부차적으로 생기는 의문점들에 대해 정리해보았다.  

### ❓ static 변수들은 어디에 저장될까?    
객체들의 `생명주기가 메서드 범위를 넘어걸 수 있기 때문에` 힙에 저장된다면, 메서드 범위 밖에 선언되어 있는 **원시 타입 static 변수**들은 어디에 저장되어야 할까?  
> Heap에 저장된다. 정확히는 JAVA 8 이후로 등장한 `Meta Space` 라는 특수한 공간에 저장된다. 주로 클래스 관련 데이터가 여기에 저장되는데, static 변수들은 클래스 레벨 변수이므로 여기에 저장되는 것이다.   

### ❓ 객체의 멤버 변수들은 어디에 저장될까?   
`객체와 인스턴스 변수는 힙에 저장되고, 참조변수는 스택에 저장`된다. 헷갈릴 수 있으므로 코드와 함께 이해해보자.   

```java 
public class Example {
    public static void main(String[] args) {
        Person person = new Person("Alice", 30);
        int localVar = 10;
    }
}

class Person {
    private String name;
    private int age;

    public Person(String name, int age) {
        this.name = name;
        this.age = age;
    }
}
``` 
#### 1. 힙 메모리에 할당  
- Person 객체 자체 
- 인스턴스 변수 name(String 객체) 
- 인스턴스 변수 age 

#### 2. 스택 메모리에 할당 
- 참조 변수 person(힙에 생성된 Person 객체의 메모리 주소를 저장함) 
- 지역 변수 localVar 

#### 왜 이런 구조로 저장될까? 
- 객체와 인스턴스 변수가 힙에 저장되어 동적 메모리 할당과 GC가 가능해진다.  
- 참조 변수와 지역 변수가 스택에 저장되어 빠른 액세스와 효율적인 메모리 관리가 가능해진다. 
- 객체의 생명주기가 메서드 호출 범위를 넘어설 수 있고, 여러 참조 변수가 동일한 객체를 가리킬 수 있다.  

### ❓ 원시타입 vs. 객체타입 : 어떤 자료형이 더 메모리 효율성이 좋을까? 
- 원시타입은 값을 직접 저장하고, 추가적인 메모리 오버헤드가 발생하지 않는다. 즉, int 자료형이라면 처음에 사용되는 4바이트 이외의 메모리가 소모되지 않는다.  
- 객체타입은 메모리 주소, 추가 메타데이터 등 더 많은 메모리가 사용된다.  
따라서 다양한 값을 독립적으로 사용하는 경우에는 원시타입을 사용하는 게 더 메모리 효율성이 좋다.  
> 다만 동일한 객체를 여러번 재사용 해야하는 상황이라면 원시 타입을 여러 번 생성하는 것보다 한 번 생성한 객체를 재사용 하는 게 더 효율적일 수 있다. 
