---
title: 타이틀   
date: 2022-02-23 00:12:00
categories: AWS 
published: true 
tags:
- AWS  
---

## Route53을 사용해 외부 도메인 아마존 계정에 연결하기     

도메인을 닷홈에서 구매하고 AWS로 포워딩 설정을 해 두었더니 접속이 잘 되길래 그렇게만 하면 되는 줄 알았다. 이렇게 하면 안 된다는 걸 알게 된 건, 포워딩 한 도메인 주소로 접속하면 새로고침을 할 때 마다 세션이 만료되어서다. 개발자도구로 확인해보니 3.xx.xx.xx(내 아마존 공개IP)와 abcde.kr(도메인 주소)가 별개의 사이트로 잡히고, 후자는 로그인 시 JSESSIONID가 저장되지 않았다. 프로젝트는 하나니까 소스 문제가 아니라 도메인 관련 문제일 것 같아 찾다 보니 `제대로 된 외부 도메인을 아마존 계정에 연결하는 법`을 알게 되었고, 잊지 않기 위해 기록해 둔다. 


<br/>

## AWS에서 Route53 이용하기  
Route53에서도 도메인을 구매 할 수 있다. 하지만 주소 길이 등에 따라 가격이 달라지고, 나는 kr(한국) 도메인을 사용하고 싶어서 `닷홈`에서 외부 도메인을 구매해 등록만 해 보기로 했다.  
![이미지](https://i.imgur.com/vCB54oY.png)  
우선, Route53의 호스팅 영역에서 `호스팅 영역 생성`을 누른다.  
<br />  
![이미지](https://i.imgur.com/pNPzvDI.png)  
`외부 도메인에서 구입한 주소`를 도메인 이름에 입력한다. 나머지는 선택 사항이므로 그대로 두면 된다. `호스팅 영역 생성`을 눌러보자.  
<br />  
![이미지](https://i.imgur.com/GJJ8vvi.png) 
호스팅 영역 생성이 완료되면 위 이미지처럼 두 개의 호스팅 영역이 생성되어 있을 것이다. 유형이 `NS`인 항목의 `값/트래픽 라우팅 대상`을 보면, 네 개의 서버 주소가 보인다. 이게 우리 사이트의 `네임 서버` 주소다. 이 주소들을 복사해서 도메인을 구입한 사이트로 가 보자.  
<br />
![이미지](https://i.imgur.com/Gdwk2G9.png) 
사이트 도메인 관리 메뉴 어딘가에 `네임서버 변경` 등의 메뉴가 있을 것이다. 기존에 등록되어 있던 네임서버들 대신, 위에서 생성된 레코드의 네임서버 네 개를 입력해준다. 이 때, 주소 마지막의 `.`는 떼고 입력해준다. 
<br />  
![이미지](https://i.imgur.com/no0WZY5.png) 
아직 끝이 아니다. 등록한 도메인을 내 아마존 계정과 연결하는 일이 남아있다. `EC2`의 인스턴스에서 미리 받아 둔 `탄력적 IP 주소`를 복사한다.   
<br />  
![이미지](https://i.imgur.com/utW5BQG.png)
다시 Route53의 호스팅 영역 세부 정보를 보자. 주황색 `레코드 생성` 메뉴가 보인다. 이걸 눌러보자.  
<br />  
![이미지](https://i.imgur.com/ki8PbrG.png)
필수로 입력해야 하는 건 `값`부분이다. 여기에 아까 복사해 둔 `탄력적 IP주소`를 입력한다. 레코드 이름은 도메인 앞에 다른 주소가 붙는다면(ex. shop.example.kr) 입력해주면 된다. 레코드 유형은 `A`로 두면 된다.  

<br />
<br />
여기까지 하면 네임서버 변경 및 외부 도메인 연결이 끝난다. 네임서버 변경 까지 최대 2일이 걸릴 수 있다고 안내하기는 하는데 보통 수십 분에서 한두 시간 내로 연결이 완료된다. 당장 안 된다고 조바심을 내면서 이것저것 다시 건드리지는 말고 몇 시간 인내심을 가지고 기다려 보면 된다. 
